#!/usr/bin/env zsh
#安装插件或软件

# 插件名称
name=$1

function _install() {
    _name=$1
    plugin_home=$(wzsh plugin home ${_name})
    if [[ -d $plugin_home ]]
    then
        # 先安装 brew 应用
        brewfile=${plugin_home}/Brewfile
        if [[ -f $brewfile ]]
        then
            zinfo "安装 Brew 软件 ${brewfile}"
            brew bundle install --file=$brewfile
        fi

        # 进行自定义安装
        installer=${plugin_home}/installer
        test -f $installer && zinfo "执行自定义安装 ${installer}"; $installer
    else
        zwarn $_name "插件不存在"
    fi
}


if [[ ! "${name}" ]]; then
    for plugin in "${WZSH_PLUGINS[@]}"; do
        _install "${plugin}"
    done
else
    _install "${name}"
fi
